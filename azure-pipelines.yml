trigger:
  branches:
    include:
      - none

pool:
  vmImage: 'ubuntu-latest'

steps:
  # Step 1: Use Node.js version 15.x
  - task: NodeTool@0
    inputs:
      versionSource: 'spec'
      versionSpec: '15.x'

  # Step 2: Install dependencies with npm
  - task: Npm@1
    inputs:
      command: 'install'
      workingDir: '$(System.DefaultWorkingDirectory)/codebase/rdicidr-0.1.0'

  # Step 3: Run Linter (ESLint)
  - script: |
      cd $(System.DefaultWorkingDirectory)/codebase/rdicidr-0.1.0 && npm run lint
    displayName: 'Run Linter (ESLint)'

  # Step 4: Run Formatter (Prettier)
  - script: |
      cd $(System.DefaultWorkingDirectory)/codebase/rdicidr-0.1.0 && npm run prettier
    displayName: 'Run Formatter (Prettier)'

  # Step 5: Run Tests (Jest)
  - script: |
      cd $(System.DefaultWorkingDirectory)/codebase/rdicidr-0.1.0 && CI=true npm run test
    displayName: 'Run Tests (Jest)'

  # Step 6: Run Build
  - script: |
      cd $(System.DefaultWorkingDirectory)/codebase/rdicidr-0.1.0 && npm run build
    displayName: 'Run Build'
